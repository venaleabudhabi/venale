# Render Deployment Guide for REVIVE Refuel

## Prerequisites
1. GitHub repository (already done ‚úÖ)
2. Render account (free tier available)
3. MongoDB Atlas database (already configured ‚úÖ)

## Deployment Steps

### Option 1: Automatic Deployment (Blueprint)

1. **Go to Render Dashboard**
   - Visit https://render.com
   - Sign up or log in with GitHub

2. **Create New Blueprint**
   - Click "New" ‚Üí "Blueprint"
   - Connect your GitHub repository: `venaleabudhabi/venale`
   - Render will auto-detect `render.yaml`

3. **Configure Environment Variables**
   
   **Backend Environment Variables:**
   - `MONGODB_URI` - Your MongoDB Atlas connection string:
     ```
     mongodb+srv://roobiin:Roobiin18@onlineqrmenu.kma4at7.mongodb.net/revive-refuel?retryWrites=true&w=majority
     ```
   - `JWT_SECRET` - Auto-generated by Render
   - `PORT` - 5001 (already set)
   - `FRONTEND_URL` - Will be set after frontend deployment

   **Frontend Environment Variables:**
   - `NEXT_PUBLIC_API_URL` - Auto-linked to backend URL

4. **Deploy**
   - Click "Apply" to deploy both services
   - Wait 5-10 minutes for initial build

---

### Option 2: Manual Deployment

#### Deploy Backend First

1. **Create Web Service**
   - Dashboard ‚Üí New ‚Üí Web Service
   - Connect GitHub repo
   - Settings:
     - **Name**: `revive-backend`
     - **Root Directory**: `backend`
     - **Environment**: `Node`
     - **Build Command**: `npm install && npm run build`
     - **Start Command**: `npm start`
     - **Plan**: Free

2. **Environment Variables** (Backend)
   ```
   NODE_ENV=production
   PORT=5001
   MONGODB_URI=mongodb+srv://roobiin:Roobiin18@onlineqrmenu.kma4at7.mongodb.net/revive-refuel?retryWrites=true&w=majority
   JWT_SECRET=[auto-generated]
   FRONTEND_URL=https://revive-frontend.onrender.com
   ```

3. **Deploy Backend**
   - Click "Create Web Service"
   - Note the backend URL: `https://revive-backend.onrender.com`

#### Deploy Frontend Second

1. **Create Web Service**
   - Dashboard ‚Üí New ‚Üí Web Service
   - Connect GitHub repo
   - Settings:
     - **Name**: `revive-frontend`
     - **Root Directory**: `frontend`
     - **Environment**: `Node`
     - **Build Command**: `npm install && npm run build`
     - **Start Command**: `npm start`
     - **Plan**: Free

2. **Environment Variables** (Frontend)
   ```
   NODE_ENV=production
   NEXT_PUBLIC_API_URL=https://revive-backend.onrender.com
   ```

3. **Deploy Frontend**
   - Click "Create Web Service"
   - Frontend URL: `https://revive-frontend.onrender.com`

4. **Update Backend FRONTEND_URL**
   - Go back to backend service
   - Update `FRONTEND_URL` to actual frontend URL
   - Service will auto-redeploy

---

## Post-Deployment

### 1. Test the Application
- **Frontend**: `https://revive-frontend.onrender.com/m/revive-refuel-venale`
- **Backend API**: `https://revive-backend.onrender.com/api/menu?lang=en`

### 2. Update Local Environment
Update your local `.env.local` to test with production backend:
```bash
NEXT_PUBLIC_API_URL=https://revive-backend.onrender.com
```

### 3. Custom Domain (Optional)
- Go to Settings ‚Üí Custom Domain
- Add your domain: `menu.reviverefuel.ae`
- Update DNS records as instructed

---

## Important Notes

### Free Tier Limitations
- ‚ö†Ô∏è **Cold Starts**: Services sleep after 15 minutes of inactivity
- ‚ö†Ô∏è **First Load**: May take 30-50 seconds to wake up
- ‚úÖ **750 hours/month** free per service
- ‚úÖ Automatic HTTPS

### Database Connection
- MongoDB Atlas is already cloud-hosted ‚úÖ
- No changes needed to connection string
- Ensure IP whitelist allows all (`0.0.0.0/0`)

### Auto-Deploy
- Render auto-deploys on every `git push` to main branch
- Monitor builds in Render Dashboard

---

## Troubleshooting

### Build Failures
```bash
# Check build logs in Render Dashboard
# Common issues:
- Missing dependencies ‚Üí Clear build cache
- TypeScript errors ‚Üí Fix locally and push
- Memory limits ‚Üí Upgrade to paid plan
```

### API Connection Issues
```bash
# Verify CORS settings in backend/src/server.ts
# Should allow frontend domain
```

### Database Connection
```bash
# MongoDB Atlas ‚Üí Network Access ‚Üí Add IP: 0.0.0.0/0
# Or add Render's IP ranges
```

---

## URLs After Deployment

| Service | URL |
|---------|-----|
| Frontend | `https://revive-frontend.onrender.com` |
| Backend API | `https://revive-backend.onrender.com` |
| Menu Page | `https://revive-frontend.onrender.com/m/revive-refuel-venale` |
| Staff Dashboard | `https://revive-frontend.onrender.com/staff/orders` |
| Driver Portal | `https://revive-frontend.onrender.com/driver/orders` |

---

## Next Steps

1. ‚úÖ Deploy to Render
2. ‚úÖ Test all features
3. üîÑ Configure custom domain
4. üîÑ Set up monitoring/alerts
5. üîÑ Implement ADCB production credentials
6. üîÑ Enable Apple Pay domain verification
7. üîÑ Set up SSL certificates for payment

---

## Monitoring

- **Render Dashboard**: Real-time logs and metrics
- **MongoDB Atlas**: Database performance monitoring
- **Application Logs**: Available in Render console

For support: https://render.com/docs
